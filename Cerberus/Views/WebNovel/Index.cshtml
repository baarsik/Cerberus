@model WebNovelIndexViewModel

@{
    ViewBag.Title = "Web Novels";
}

<div class="row">
    <div class="col-lg-12">
        <div class="view-header">
            <div class="header-icon">
                <i class="fal fa-book fa-sm"></i>
            </div>
            <div class="pull-right text-right">
                @if (User.HasWebNovelEditorAccess())
                {
                    <a class="btn btn-lg btn-default" asp-action="AddWebNovel">
                        <i class="far fa-plus"></i>
                        New
                    </a>
                }
            </div>
            <div class="header-title">
                <h3>Web Novels</h3>
                <small>
                    List of web novels
                </small>
            </div>
        </div>
        <hr>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <div class="panel">
            <div class="panel-body">
                @if (Model.Items.Any())
                {
                    foreach (var item in Model.Items)
                    {
                         <div class="panel panel-filled panel-c-warning">
                             <div class="panel-heading">
                                 <a class="no-text-decoration" asp-action="Details" asp-route-webNovelUrl="@item.WebNovel.UrlName">
                                     <h3>@item.WebNovel.Name</h3>
                                 </a>
                                 @if (item.WebNovel.UsesVolumes)
                                 {
                                     <div class="badge">Volumes: @item.TotalVolumes</div>
                                 }
                                 <div class="badge">Chapters: @item.TotalChapters</div>
                                 @if (item.LastUpdateDate.HasValue)
                                 {
                                     <div class="badge">Last update: @item.LastUpdateDate.Value.ToFormattedString()</div>
                                 }
                                 @if (item.WebNovel.IsComplete)
                                 {
                                     <div class="badge badge-accent">Complete</div>
                                 }
                             </div>
                             <div class="panel-body overflow-100">
                                 @Html.Raw(item.WebNovel.Description)
                             </div>
                             <div class="panel-footer">
                                 <a class="btn btn-sm btn-default" asp-action="Details" asp-route-webNovelUrl="@item.WebNovel.UrlName">Details</a>
                                 @if (item.TotalChapters > 0)
                                 {
                                     if (item.WebNovel.UsesVolumes)
                                     {
                                         <a class="btn btn-sm btn-default" asp-action="Read"
                                            asp-route-languageCode="@item.LastChapterTranslation.Language.Code"
                                            asp-route-volume="@item.LastChapterTranslation.Chapter.Volume"
                                            asp-route-webNovelUrl="@item.WebNovel.UrlName"
                                            asp-route-chapterNumber="@item.LastChapterTranslation.Chapter.Number">
                                             Read chapter @item.LastChapterTranslation.Chapter.Number (Volume @item.LastChapterTranslation.Chapter.Volume)
                                         </a>
                                     }
                                     else
                                     {
                                         <a class="btn btn-sm btn-default" asp-action="Read"
                                            asp-route-languageCode="@item.LastChapterTranslation.Language.Code"
                                            asp-route-webNovelUrl="@item.WebNovel.UrlName"
                                            asp-route-chapterNumber="@item.LastChapterTranslation.Chapter.Number">
                                             Read chapter @item.LastChapterTranslation.Chapter.Number
                                         </a>
                                     }
                                 }
                             </div>
                         </div>
                    }
                    <paginator asp-action="Index" model="@Model"/>
                }
                else
                {
                    <div>Sorry, the list of web novels is empty</div>
                }
            </div>
        </div>
    </div>
</div>