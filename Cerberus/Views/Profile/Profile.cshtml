@model ProfileViewModel

@{
    ViewBag.Title = Model.User.DisplayName;
    var profileRouteData = new Dictionary<string, string>
    {
        {"name", Model.User.DisplayName}
    };
}

<div class="flex-column">
    <div class="flex-row m-b">
        <div class="avatar m-r">
            @if (Model.User.Avatar == "noavatar")
            {
                <i class="fas fa-user"></i>
            }
            else
            {
                <img src="~/images/avatars/@Model.User.Avatar" alt="Avatar"/>
            }
        </div>
        <div class="flex-column">
            <div class="profile-name">
                <div>@Model.User.DisplayName</div>
            </div>
            <div>
                @Localizer["RegisteredOn"] @Model.User.RegisterDate.ToLongDateString()
            </div>
            @if (Model.IsOwnProfile)
            {
                <div class="m-t-xs">
                    <a class="btn btn-default btn-xs" asp-action="ChangePassword" asp-controller="Account">@Localizer["ChangePasswordButton"]</a>
                    <a class="btn btn-default btn-xs" asp-action="EditProfile" asp-controller="Account">@Localizer["EditProfileButton"]</a>
                </div>
            }
        </div>
    </div>
    @if (Model.IsOwnProfile && false)
    {
        <div class="row">
            <div class="col-lg-12">
                <div class="panel panel-filled panel-c-warning">
                    <div class="panel-heading">
                        @Localizer["APIData_Title"]
                    </div>
                    <div class="panel-body confidential">
                        <div>
                            <i class="fas fa-key"></i> @Localizer["APIData_Key"]:
                            <span class="spoiler">@Model.User.ApiKey</span>
                        </div>
                        <div class="m-t-xs">
                            <a class="btn btn-default btn-xs" asp-action="RegenerateApiKey" asp-controller="Profile">@Localizer["APIData_RegenerateKeyButton"]</a>
                        </div>
                        <div class="m-t">
                            @Localizer["APIData_YourProducts"]:
                            @if (Model.ProductLicenses.Any())
                            {
                                <ol class="counter">
                                    @foreach (var license in Model.ProductLicenses)
                                    {
                                        if (license.IsExpired() || license.IsBlocked)
                                        {
                                            <li class="text-danger">@license</li>
                                        }
                                        else
                                        {
                                            <li>@license</li>
                                        }
                                    }
                                </ol>
                            }
                            else
                            {
                                <span>@Localizer["APIData_NoProducts"]</span>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    }
    <div class="row">
        @*<div class="col-lg-6">
            <div class="panel panel-filled panel-c-warning">
                <div class="panel-heading">
                    News statistics
                </div>
                <div class="panel-body">
                    <div>Total news: @Model.Statistics.News.TotalNews</div>
                    <div>Total comments: @Model.Statistics.News.TotalComments</div>
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="panel panel-filled panel-c-warning">
                <div class="panel-heading">
                    Forum statistics
                </div>
                <div class="panel-body">
                    <div>Total threads: @Model.Statistics.Forum.TotalStartedThreads</div>
                    <div>Total replies: @Model.Statistics.Forum.TotalReplies</div>
                </div>
            </div>
        </div>*@
        <div class="col-lg-12">
            <div class="panel panel-filled panel-c-warning">
                <div class="panel-heading">
                    @Localizer["WNStats_Title"]
                </div>
                <div class="panel-body">
                    <div><b>@Localizer["WNStats_TotalWNs"]:</b> @Model.Statistics.WebNovel.TotalWebNovels</div>
                    <div><b>@Localizer["WNStats_TotalChapters"]:</b> @Model.Statistics.WebNovel.TotalChapters</div>
                </div>
            </div>
        </div>
    </div>
    
    @if (this.IsInDebugMode() && Model.IsOwnProfile)
    {
        <div class="row">
            <div class="col-lg-12">
                <div class="panel panel-filled panel-c-warning">
                    <div class="panel-heading">
                        Debug info
                    </div>
                    <div class="panel-body">
                        <div>
                            <div class="font-bold text-accent">
                                Claims:
                            </div>
                            <div>
                                @Html.Raw(User.Claims
                                    .Select(c => $"<span class=\"text-success\">{c.Type}:</span> {c.Value}")
                                    .Aggregate((current, next) => $"{current}<br/>{next}"))
                            </div>
                        </div>
                        <div class="m-t">
                            <div class="font-bold text-accent">
                                Additional info:
                            </div>
                            <div>
                                <span class="text-success">Is Admin:</span> @User.IsAdmin()
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    }
</div>